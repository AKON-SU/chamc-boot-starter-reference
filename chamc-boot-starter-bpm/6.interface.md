# SDK接口

## 说明

SDK接口能够让开发人员快速的开发应用，进行灵活的流程应用的支持。在SDK中封装了工作流引擎提供的各种服务，为开发人员提供便利。

## 接入方式

    chamc.bpm.type=chamc
    chamc.bpm.chamc.tenant-id=xxx   #租户code
    chamc.bpm.chamc.log-level=xxx   #日志级别，basic full headers none

    #添加token配置项
    chamc.service.token=xxx #会先找该token，没有的话找chamc.service.bpm.token=

## 获取接口的方式

目前SDK主要提供3类的接口，包路径为`com.chamc.boot.bpm.service`，接口分类列表如下：

<table>
   <tr>
      <td>编号</td>
      <td>interface</td>
      <td>描述</td>
   </tr>
   <tr>
      <td>1</td>
      <td>IInstanceService</td>
      <td>流程实例相关的service，包括流程启动、终止以及根据流程实例/定义的一些查询方法</td>
   </tr>
   <tr>
      <td>2</td>
      <td>ITaskService</td>
      <td>任务相关service，包括查询待办、已办，等</td>
   </tr>
   <tr>
      <td>3</td>
      <td>IModelService</td>
      <td>直接根据模型进行的查询</td>
   </tr>
</table>

## 接口列表

**IInstanceService**

<table>
   <tr>
      <td>1</td>
      <td>startBpm</td>
      <td>StartBpmParam</td>
      <td>StartBpmResult</td>
      <td>启动流程，启动参数中有不同情况的处理</td>
   </tr>
   <tr>
      <td>2</td>
      <td>terminateBpm</td>
      <td>userId,instanceId</td>
      <td>~</td>
      <td>终止流程</td>
   </tr>
   <tr>
      <td>2</td>
      <td>terminateBpm</td>
      <td>userId,instanceId,comment</td>
      <td>~</td>
      <td>终止流程</td>
   </tr>
   <tr>
      <td>3</td>
      <td>queryTransferDetail</td>
      <td>instanceId</td>
      <td>`List<ProcessTransferDetail>`</td>
      <td>获取流转明细</td>
   </tr>
   <tr>
      <td>4</td>
      <td>getProcessVariables</td>
      <td>instanceId</td>
      <td>`List<Variable>`</td>
      <td>获取流程变量</td>
   </tr>
   <tr>
      <td>5</td>
      <td>queryProcessInstance</td>
      <td>processKey</td>
      <td>`List<ProcessInstance>`</td>
      <td>获取指定流程key对应的运行中的流程实例</td>
   </tr>
</table>

**ITaskService**

注：page对象为分页对象，结果包含分页信息、排序信息及结果content；

<table>
   <tr>
      <td>编号</td>
      <td>方法</td>
      <td>入参</td>
      <td>出参</td>
      <td>描述</td>
   </tr>
   <tr>
      <td>1</td>
      <td>queryTodo</td>
      <td>userId,pageable</td>
      <td>`Page TaskTodo`</td>
      <td>分页查询待办列表</td>
   </tr>
   <tr>
      <td>1</td>
      <td>queryTodo</td>
      <td>userId,processDefineKey,pageable</td>
      <td>`Page TaskTodo`</td>
      <td>~</td>
   </tr>
   <tr>
      <td>1</td>
      <td>queryTodo</td>
      <td>QueryTaskParam,pageable</td>
      <td>`Page TaskTodo`</td>
      <td>QueryTaskParam对象通过instance静态方法构造，用流式api设置值，如QueryTaskParam param = QueryTaskParam.instance().userId(userId).processDefineKey(processKey);</td>
   </tr>
   <tr>
      <td>2</td>
      <td>getTaskTodo</td>
      <td>taskId, userId</td>
      <td>`TaskTodo`</td>
      <td>按照taskId查询待办任务</td>
   </tr>
   <tr>
      <td>3</td>
      <td>queryDone</td>
      <td>userId,pageable</td>
      <td>`Page TaskDone`</td>
      <td>分页查询已办列表</td>
   </tr>
   <tr>
      <td>3</td>
      <td>queryDone</td>
      <td>userId,processDefineKey,pageable</td>
      <td>`Page TaskDone`</td>
      <td>~</td>
   </tr>
   <tr>
      <td>3</td>
      <td>queryDone</td>
      <td>QueryTaskParam,pageable</td>
      <td>`Page TaskDone`</td>
   </tr>
   <tr>
      <td>4</td>
      <td>getTaskDone</td>
      <td>taskId, userId</td>
      <td>`TaskDone`</td>
      <td>根据taskId查询已办任务</td>
   </tr>
   <tr>
      <td>5</td>
      <td>countTask</td>
      <td>userId</td>
      <td>`TaskCount`</td>
      <td>查询待办任务总数和各个流程定义下的待办总数</td>
   </tr>
   <tr>
      <td>6</td>
      <td>completeTask</td>
      <td>taskId,userId</td>
      <td>~</td>
      <td>同意审批/完成任务</td>
   </tr>
   <tr>
      <td>6</td>
      <td>completeTask</td>
      <td>taskId,userId,variables</td>
      <td>~</td>
      <td>~</td>
   </tr>
   <tr>
      <td>6</td>
      <td>completeTask</td>
      <td>taskId,userId,comment</td>
      <td>~</td>
      <td>~</td>
   </tr>
   <tr>
      <td>6</td>
      <td>completeTask</td>
      <td>taskId,userId,comment,variables</td>
      <td>~</td>
      <td>~</td>
   </tr>
   <tr>
      <td>7</td>
      <td>completeTask</td>
      <td>taskId,userId, nextOrgId,comment,variables</td>
      <td>~</td>
      <td>~</td>
   </tr>
   <tr>
      <td>7</td>
      <td>completeAndAssign</td>
      <td>taskId,userId,nextParticipates</td>
      <td>~</td>
      <td>提交任务并指派下一节点参与人</td>
   </tr>
   <tr>
      <td>7</td>
      <td>completeAndAssign</td>
      <td>taskId,userId,nextParticipates</td>
      <td>~</td>
      <td>~</td>
   </tr>
   <tr>
      <td>7</td>
      <td>completeAndAssign</td>
      <td>taskId,userId,nextParticipates,variables</td>
      <td>~</td>
      <td>~</td>
   </tr>
   <tr>
      <td>8</td>
      <td>addSign</td>
      <td>taskId,userIds</td>
      <td>~</td>
      <td>给当前任务加签</td>
   </tr>
   <tr>
      <td>8</td>
      <td>addSign</td>
      <td>taskId,userIds,comment</td>
      <td>~</td>
      <td>~</td>
   </tr>
   <tr>
      <td>9</td>
      <td>reject</td>
      <td>taskId,userId</td>
      <td>~</td>
      <td>驳回到上一节点</td>
   </tr>
   <tr>
      <td>9</td>
      <td>reject</td>
      <td>taskId,userId,variables</td>
      <td>~</td>
      <td></td>
   </tr>
   <tr>
      <td>9</td>
      <td>reject</td>
      <td>taskId,userId,comment</td>
      <td>~</td>
      <td></td>
   </tr>
   <tr>
      <td>9</td>
      <td>reject</td>
      <td>taskId,userId,comment,variables</td>
      <td>~</td>
      <td></td>
   </tr>
   <tr>
      <td>10</td>
      <td>rejectToFirst</td>
      <td>taskId,userId</td>
      <td>~</td>
      <td>驳回到制单节点</td>
   </tr>
   <tr>
      <td>10</td>
      <td>rejectToFirst</td>
      <td>taskId,userId,variables</td>
      <td>~</td>
      <td></td>
   </tr>
   <tr>
      <td>10</td>
      <td>rejectToFirst</td>
      <td>taskId,userId,comment</td>
      <td>~</td>
      <td></td>
   </tr>
   <tr>
      <td>10</td>
      <td>rejectToFirst</td>
      <td>taskId,userId,comment,variables</td>
      <td>~</td>
      <td></td>
   </tr>
   <tr>
      <td>11</td>
      <td>rejectToSpecified</td>
      <td>taskId,userId,activityId</td>
      <td>~</td>
      <td>驳回到指定节点</td>
   </tr>
   <tr>
      <td>11</td>
      <td>rejectToSpecified</td>
      <td>taskId,userId,activityId,variables</td>
      <td>~</td>
      <td></td>
   </tr>
   <tr>
      <td>11</td>
      <td>rejectToSpecified</td>
      <td>taskId,userId,activityId,comment</td>
      <td>~</td>
      <td></td>
   </tr>
   <tr>
      <td>11</td>
      <td>rejectToSpecified</td>
      <td>taskId,userId,activityId,comment,variables</td>
      <td>~</td>
      <td></td>
   </tr>
   <tr>
      <td>12</td>
      <td>delegate</td>
      <td>taskId,userId,toUserId</td>
      <td>~</td>
      <td>转办任务</td>
   </tr>
   <tr>
      <td>12</td>
      <td>delegate</td>
      <td>taskId,userId,toUserId,comment</td>
      <td>~</td>
      <td></td>
   </tr>
   <tr>
      <td>13</td>
      <td>reBack</td>
      <td>taskId,userId,comment,variables</td>
      <td>~</td>
      <td>取回任务</td>
   </tr>
   <tr>
      <td>14</td>
      <td>queryNextTaskInfo</td>
      <td>taskId,userId,nextOrgId,variables</td>
      <td>NextTaskInfo</td>
      <td>查询下一节点参与人等信息</td>
   </tr>
   <tr>
      <td>15</td>
      <td>queryNextTaskConfig</td>
      <td>taskId,userId,nextOrgId,variables</td>
      <td>List < ActivityConfig ></td>
      <td>查询下一节点配置信息</td>
   </tr>
</table>

**IModelService**

<table>
    <tr>
      <td>1</td>
      <td>getConfigById</td>
      <td>procDefId,activityDefId</td>
      <td>ActivityConfig</td>
      <td>查询指定流程+指定节点的配置信息</td>
   </tr>
   <tr>
      <td>2</td>
      <td>getInitialActivity</td>
      <td>processKey,skipFirst,variables</td>
      <td>List < ActivityConfig ></td>
      <td>查询制单节点/制单后节点配置信息</td>
   </tr>
</table>